<HTML>
<HEAD>
   <TITLE>MZ700WIN FAQ</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#EF0F2F" VLINK="#9F000F" ALINK="#FF8F4F">

<H2>MZ700WIN FAQ</H2>

<CENTER><FONT SIZE=+0>Last update: 2000/10/27</FONT></CENTER>

<p>

<TABLE BORDER=1 width=100%>
<TR>
<TH BGCOLOR=00FF99>更新日時</TH><TH BGCOLOR=00FF99>質問内容</TH>
</TR>
<TR>
<TD bgcolor=eeeeee>00/03/27</TD>
<TD bgcolor=eec0ee><a href="#q01-01">１２００のモニタＢＩＯＳでも動作するんでしょうか？</a></TD>
</TR>
<TR>
<TD bgcolor=eeeeee>98/04/19</TD>
<TD bgcolor=eec0ee><a href="#q01-02">ＭＺ−８０Ｋシリーズ、１２００エミュレータは作らないんですか？</a></TD>
</TR>
<TR>
<TD bgcolor=eeeeee>98/05/31</TD>
<TD bgcolor=eec0ee><a href="#q01-03">データレコーダのモータのゴムが風化していて、データが吸い出せないのですが？</A></TD>
</TR>
<TR>
<TD bgcolor=eeeeee>98/04/19</TD>
<TD bgcolor=eec0ee><a href="#q01-04">FN700ってなんなのでしょうか？</a></TD>
</TR>
<TR>
<TD bgcolor=eeeeee>00/03/27</TD>
<TD bgcolor=eec0ee><a href="#q01-05">tapeloadの終了が、MZ側の「Write OK!」が出るよりも
ずいぶん早いのですが、これはそんなものなのでしょうか？</a></TD>
</TR>

<TR>
<TD bgcolor=eeeeee>98/04/19</TD>
<TD bgcolor=eec0ee><a href="#q02-01">ＭＺ−１５００でファイルのアドレスを調べる方法は？</a></TD>
</TR>

<TR>
<TD bgcolor=eeeeee>00/08/13</TD>
<TD bgcolor=eec0ee><a href="#q03-01">＊．ＭＺＴファイルのファイルフォーマットを教えて下さい。</a></TD>
</TR>

<TR>
<TD bgcolor=eeeeee>98/04/19</TD>
<TD bgcolor=eec0ee><a href="#q04-01">動作遅いんですけど何とかならないでしょうか。</a></TD>
</TR>


</TABLE>

<P><B><A HREF="http://retropc.net/mz-memories/mz700/">＜＜＜＜MZ700WINページに戻る</A></B>

<hr>
<a name="q01-01"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  １２００のモニタＢＩＯＳでも動作するんでしょうか？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
  動作保証外ですが、mz700win 0.52では、SP-1002のイメージを「SP1002.ROM」として用意する事で
動作するようです。その際、Keyboardメニューから、MZ-80K/C/1200用のキーボードマトリクスを選択するようにして下さい。
<hr>
<a name="q01-02"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  ＭＺ−８０Ｋシリーズ、１２００エミュレータは作らないんですか？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
  作者が実機を持っていないので作れません。作る予定もありません。

<hr>
<a name="q01-03"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  データレコーダのモータのゴムが風化していて、データが吸い出せないのですが？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
以下の材料を用意して下さい。<br>
<ul>
   <li>JSTの9ピンコネクタ
   <li>線材 少々
</ul>
　おもむろに「TO RECORDER」端子に繋がっているデーターレコーダーを外して、用意した材料を使って
1-7、2-8、3-5の3本を繋いで作ったアダプタを空いたコネクタに差せばＯＫ！
これで、背面の「WRITE」端子から出てくる生データーが「TAPELOAD」で、スイスイ読めます。
「-d」は10程度に設定するとよろしいようです。<p>

　mz1500はそのままで「WRITE」端子から出てます。
<p>
　　(Thanks to みんたぁさん）

<hr>
<a name="q01-04"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  FN700ってなんなのでしょうか？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
  Oh!MZ83年4月号か、ADVANCED MZ-700に掲載されています。<br>
  MZ-700の1Z-009Aは代表的なサブルーチンエントリをSP-1002と合わせてありますが、
機能としてはメモリエディットができたりキーリピートがあったりと増加しているので、
内部ルーチンとしては大幅に変更されています。<br>
  そこで、80K/Cと700のアーキテクチャに大幅な変更がないことを利用して、
MZ-700の0000〜0FFF番地をRAMに切り替えたうえでそこにSP-1002をロードすればいいのではないかという考えがでてきます。<br>
実際には細かいところで違いがあるので、それを吸収するためのパッチを施したものがFN-700です。<p>

　　パッチをあてて修正する項目は、記憶の限りでは以下のとおりです。
<ul>
　　<li><b>1) キーマトリクスの変更</b><br>
    80K/Cと700ではキーの数が違いますので、相当にアサインが変更されているのを合わせます。<p>

    <li><b>2) キーに対する文字の変更</b><br>
    同じくキー数の減少によりひとつのキーに割り当てる文字の数が増えたりしているので、その変換テーブルを交換します。<p>

    <li><b>3) 8253のモード変更</b><br>
    80K/Cと700で、設定されている8253の動作モードが違うのだそうです。これはハードに合わせることになります。<p>

    <li><b>4) ボーレートの変更</b><br>
    クロックが早くなっているので、ボーレートのパラメータを変更します。<br>
    記事としては適当なアドレスにロードしてRAMに転送することになっていますが、mz700winでは
    FN-700をそのままROMデータとする使い方ができると思います。<br>

    但し、mz700winのテープ入力はI/Oポートエミュレートでなく特定のアドレスに対してパッチを
    当てる方法をとっているので1Z-009A/B以外のモニタは動きません。キーが入力できるとか、
    コマンドが違うのを確認する程度で終わりです。
</ul>

　　(Thanks to Ｏｈ！石さん）
<hr>
<a name="q01-05"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  tapeloadの終了が、MZ側の「Write OK!」が出るよりも
ずいぶん早いのですが、これはそんなものなのでしょうか？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
テープにセーブされる時は、同じ内容が2回セーブされるため
ロードがうまくいけば、セーブの半分の時間で終了することになります。
<hr>


<a name="q02-01"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  ＭＺ−１５００でファイルのアドレスを調べる方法は？<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
  1500のモニタ(9Z-502M)で、QCコマンドを使い、目的のファイルネームを入れ、ロードが終わったら(Y/N)か聞いてきますので、
Ｎを押しキャンセルし、Dコマンドで以下のアドレスを参照してみて下さい。<p>

　　$1104 データ・サイズ<br>
　　$1106 データ先頭アドレス<br>
　　$1108 スタート・アドレス <p>

　　ただ注意しないといけないのは、QCコマンドで読み込まれているファイルは、必ず$1200からになってしまいますので、
    その点はご注意下さい。 

<hr>
<a name="q03-01"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  ＊．ＭＺＴファイルのファイルフォーマットを教えて下さい。<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
  基本的には、テープが読み込まれる順番にheader,data,header,data…と、ベタで連結してあるだけです。<p>

ヘッダ部：１２８バイト<br>

<table border=1>
<tr>
<td>オフセット</td><td></td>
</tr>

<tr>
<td>00h</td>
<td>アトリビュート</td>
</tr>
<tr>
<td>01h〜11h</td>
<td>ファイル名。20hでパディングします。</td>
</tr>

<tr>
<td>12h,13h</td>
<td>ファイルサイズ</td>
</tr>

<tr>
<td>14h,15h</td>
<td>格納アドレス</td>
</tr>

<tr>
<td>16h,17h</td>
<td>実行アドレス</td>
</tr>
</table>

   ディスクだと続きに格納位置(FATとかビットマップとか)が入るそうです。
   残りは00Hで埋めてあります。<p>

   ヘッダに続いて、実データが並びます。<br>
   テープではチェックサムが最後に入っていますが、ごく単純に生データのみ入れればいいわけです。
   複数ファイルが連結されているものは、基本のヘッダ＋データが順番につながっているだけです。<p> 

　　(Thanks to Ｏｈ！石さん）
<p>
　mz700win version0.51以降では、40h以降を独自の目的で使用しています。
読み込まれたmztファイルを実行する直前に、ＲＡＭにパッチを当てるためのデータが続いています。
<p>
<table border=1>
<tr>
<td>オフセット</td><td></td>
</tr>

<tr>
<td>40h〜43h</td>
<td>'PAT:' (パッチ当てデータを識別するためのシグネチャ)</td>
</tr>
<tr>
<td>44h〜45h</td>
<td>パッチ当て開始アドレス。FFFFhの場合はデータ終了</td>
</tr>

<tr>
<td>46h</td>
<td>データ長</td>
</tr>

<tr>
<td>47h〜</td>
<td>パッチデータ列</td>
</tr>

<tr>
<td>XXh〜</td>
<td>パッチ当て開始アドレス,データ長,データ列．．．．</td>
</tr>
</table>



<hr>
<a name="q04-01"></a>
<FONT SIZE=6 COLOR=0000C0>Ｑ．</FONT>
  動作遅いんですけど何とかならないでしょうか。<br>

<FONT SIZE=6 COLOR=C00000>Ａ．</FONT>
申し訳ありません。<br>
環境によっては、ウィンドウ２倍モードを使うと、
ビデオカードの性能によっては遅くなりますので、
その場合は等倍モードを使用するようにして下さい。
<br>
Windowsの画面モードを２５６色にすれば速くなるかもしれませんが、
それでも遅いようでしたら、申し訳ありませんが、
ＣＰＵとビデオカードを速いものに買い替えてください。
<hr>

<P><B><A HREF="http://retropc.net/mz-memories/mz700/">＜＜＜＜MZ700WINページに戻る</A></B>
<p>

<CENTER>このページについてご意見ご希望等ありましたら、 <a href="http://marukun.org/mailform.html">こちらのフォーム</A>
からどうぞ。</CENTER>

</BODY>
</HTML>
